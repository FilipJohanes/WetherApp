{% extends "base.html" %}

{% block title %}Statistics - Daily Brief Service{% endblock %}

{% block header_subtitle %}Service Statistics{% endblock %}

{% block content %}
<div class="card">
    <h2>ğŸ“Š Daily Brief Service Statistics</h2>
    <p style="margin-top: 10px; color: #6c757d;">
        Public statistics (no personal data shown)
    </p>
</div>

<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-number">{{ total }}</div>
        <div class="stat-label">Total Subscribers</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-number">{{ total * 365 }}</div>
        <div class="stat-label">Emails/Year</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-number">3</div>
        <div class="stat-label">Languages</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-number">4</div>
        <div class="stat-label">Personalities</div>
    </div>
</div>

<div class="card" style="margin-top: 30px;">
    <h3>ğŸŒ Language Distribution</h3>
    {% if languages %}
        <div style="margin-top: 15px;">
            {% for lang in languages %}
                <div style="margin-bottom: 15px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span>
                            {% if lang.language == 'en' %}ğŸ‡¬ğŸ‡§ English{% endif %}
                            {% if lang.language == 'es' %}ğŸ‡ªğŸ‡¸ Spanish{% endif %}
                            {% if lang.language == 'sk' %}ğŸ‡¸ğŸ‡° Slovak{% endif %}
                        </span>
                        <strong>{{ lang.count }} ({{ "%.1f"|format((lang.count / total * 100) if total > 0 else 0) }}%)</strong>
                    </div>
                    <div style="background: #dee2e6; height: 20px; border-radius: 10px; overflow: hidden;">
                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); height: 100%; width: {{ (lang.count / total * 100) if total > 0 else 0 }}%; transition: width 0.5s;"></div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p style="color: #6c757d;">No language data yet</p>
    {% endif %}
</div>

<div class="card">
    <h3>ğŸ­ Personality Distribution</h3>
    {% if personalities %}
        <div style="margin-top: 15px;">
            {% for pers in personalities %}
                    {% if pers.personality in ['neutral', 'cute', 'brutal'] %}
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>
                                {% if pers.personality == 'neutral' %}ğŸ˜ Neutral{% endif %}
                                {% if pers.personality == 'cute' %}ğŸ¥° Cute{% endif %}
                                {% if pers.personality == 'brutal' %}ğŸ˜¤ Brutal{% endif %}
                            </span>
                            <strong>{{ pers.count }} ({{ "%.1f"|format((pers.count / total * 100) if total > 0 else 0) }}%)</strong>
                        </div>
                        <div style="background: #dee2e6; height: 20px; border-radius: 10px; overflow: hidden;">
                            <div style="
                                height: 100%; 
                                width: {{ (pers.count / total * 100) if total > 0 else 0 }}%; 
                                transition: width 0.5s;
                                {% if pers.personality == 'neutral' %}background: #6c757d;{% endif %}
                                {% if pers.personality == 'cute' %}background: linear-gradient(135deg, #ff6b9d 0%, #c06c84 100%);{% endif %}
                                {% if pers.personality == 'brutal' %}background: linear-gradient(135deg, #434343 0%, #000000 100%);{% endif %}
                            "></div>
                        </div>
                    </div>
                    {% endif %}
            {% endfor %}
        </div>
    {% else %}
        <p style="color: #6c757d;">No personality data yet</p>
    {% endif %}
</div>

<div class="card" style="background: #e7f3ff; border: 1px solid #0056b3;">
    <h3 style="color: #004085;">ğŸ’¡ Did You Know?</h3>
    <ul style="margin-left: 20px; margin-top: 10px; color: #004085;">
        <li>This service offers <strong>3 personality modes</strong> (neutral, cute, brutal) in multiple languages! ğŸ­</li>
        <li>Weather data comes from <strong>Open-Meteo</strong> - a free, open API with no API key required</li>
        <li>This service runs on a <strong>Raspberry Pi Zero W2</strong> with just 512MB RAM! ğŸ¥§</li>
        <li>All emails are sent at <strong>5:00 AM local time</strong> in your location's timezone</li>
    </ul>
</div>

<div style="text-align: center; margin-top: 30px;">
    <a href="{{ url_for('subscribe') }}" class="btn">
        ğŸ“§ Join {{ total }} Subscribers
    </a>
</div>
{% endblock %}
